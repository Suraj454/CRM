<app-dealstableheader></app-dealstableheader>
<!-- Qualified Leads Table -->
<!-- <table class="w-full mt-4 text-sm text-gray-700 border border-gray-200">
    <thead class="bg-gray-100">
      <tr>
        <th class="p-2">Lead Name</th>
        <th class="p-2">Lead Email</th>
        <th class="p-2">Contact No</th>
        <th class="p-2">Company Name</th>
        <th class="p-2">Company Address</th>
        <th class="p-2">Source Type</th>
        <th class="p-2">Service Name</th>
        <th class="p-2">Date</th>
        <th class="p-2">Status</th>
        <th class="p-2">Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let lead of qualifiedLeads">
        <td class="p-2">{{ lead.leadName }}</td>
        <td class="p-2">{{ lead.leadEmail }}</td>
        <td class="p-2">{{ lead.contactNo }}</td>
        <td class="p-2">{{ lead.companyName }}</td>
        <td class="p-2">{{ lead.companyAdd }}</td>
        <td class="p-2">{{ lead.sourceType }}</td>
        <td class="p-2">{{ lead.crmService.serviceName }}</td>
        <td class="p-2">{{ lead.timeDate }}</td>
        <td class="p-2">
          <span class="inline-block px-2 py-1 rounded text-xs font-semibold"
                [ngClass]="getBadgeClass(lead.leadStatus)">
            {{ lead.leadStatus }}
          </span>
        </td>
        <td class="p-2 text-center">
            <button (click)="openEmailModal(lead)" title="Send Email" class="text-blue-600 hover:text-blue-800">
              <i class="fas fa-envelope"></i>
            </button>
          </td>
      </tr>
    </tbody>
  </table> -->


  <!-- Qualified Leads Table -->

  <table class="w-full mt-4 text-sm text-gray-700 border border-gray-200">
    <thead class="bg-gray-100">
      <tr>
        <th class="p-2">Lead Name</th>
        <th class="p-2">Lead Email</th>
        <th class="p-2">Contact No</th>
        <th class="p-2">Company Name</th>
        <th class="p-2">Company Address</th>
        <th class="p-2">Source Type</th>
        <th class="p-2">Service Name</th>
        <th class="p-2">Date</th>
        <th class="p-2">Status</th>
        <th class="p-2">Action</th>
      </tr>
    </thead>
    <tbody>
  <tr *ngFor="let salesLead of qualifiedLeads">
    <td class="p-2">{{ salesLead.lead.leadsource.leadName }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.leadEmail }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.contactNo }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.companyName }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.companyAdd }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.sourceType }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.crmService.serviceName }}</td>
    <td class="p-2">{{ salesLead.lead.leadsource.timeStamp | date: 'short' }}</td>
    <td class="p-2">
      <span class="inline-block px-2 py-1 rounded text-xs font-semibold"
            [ngClass]="getBadgeClass(salesLead.lead.leadStatus)">
        {{ salesLead.lead.leadStatus }}
      </span>
    </td>
    <td class="p-2 text-center">
      <button (click)="openEmailModal(salesLead)" title="Send Email" class="text-blue-600 hover:text-blue-800">
        <i class="fas fa-envelope"></i>
      </button>
    </td>
  </tr>

</tbody>
</table> 

  
  
<!-- Email Modal -->
<div *ngIf="showEmailModal" class="fixed inset-0 flex items-center justify-center z-50 backdrop-blur-sm bg-white/50">
  <div class="bg-white rounded-lg p-8 w-full max-w-xl shadow-md relative">
    
    <!-- Close Button -->
    <button class="absolute top-3 right-3 text-gray-500 hover:text-red-500 text-xl" (click)="discardEmail()">
      <i class="fas fa-times"></i>
    </button>

    <h2 class="text-xl font-semibold mb-6 text-gray-800 flex items-center gap-2">
      <i class="fas fa-paper-plane text-blue-600"></i> Send Email
    </h2>

    <!-- To -->
    <div class="mb-5">
      <label class="block text-sm font-medium text-gray-700 mb-1">To</label>
      <div class="flex items-center border border-gray-300 rounded-md px-3 py-2 gap-2">
        <i class="fas fa-envelope text-gray-500"></i>
        <input type="email" [(ngModel)]="emailForm.to" placeholder="Recipient email"
               class="flex-1 outline-none bg-transparent" />
      </div>
    </div>

    <!-- Subject -->
    <div class="mb-5">
      <label class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
      <div class="flex items-center border border-gray-300 rounded-md px-3 py-2 gap-2">
        <i class="fas fa-heading text-gray-500"></i>
        <input type="text" [(ngModel)]="emailForm.subject" placeholder="Email subject"
               class="flex-1 outline-none bg-transparent" />
      </div>
    </div>

    <!-- Proposed Value -->
    <div class="mb-5">
      <label class="block text-sm font-medium text-gray-700 mb-1">Proposed Value</label>
      <div class="flex items-center border border-gray-300 rounded-md px-3 py-2 gap-2">
        <i class="fas fa-dollar-sign text-gray-500"></i>
        <input type="text" [(ngModel)]="emailForm.proposedValue" placeholder="Enter proposed value"
               class="flex-1 outline-none bg-transparent" />
      </div>
    </div>

    <!-- Body -->
    <div class="mb-5">
      <label class="block text-sm font-medium text-gray-700 mb-1">Body</label>
      <div class="flex items-start border border-gray-300 rounded-md px-3 py-2 gap-2">
        <i class="fas fa-align-left text-gray-500 mt-1"></i>
        <textarea [(ngModel)]="emailForm.body" rows="4" placeholder="Write your message..."
                  class="flex-1 outline-none resize-none bg-transparent"></textarea>
      </div>
    </div>

    <!-- Attachment -->
    <div class="mb-5">
      <label class="block text-sm font-medium text-gray-700 mb-1">Attachment</label>
      <div class="flex items-center gap-2">
        <i class="fas fa-paperclip text-gray-500"></i>
        <input type="file" (change)="onFileSelected($event)"
               class="text-sm text-gray-700" />
        <span *ngIf="emailForm.attachment" class="text-sm text-gray-600">{{ emailForm.attachment.name }}</span>
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex justify-end gap-3">
      <button class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-5 py-2 rounded-md" (click)="discardEmail()">
        <i class="fas fa-ban mr-2"></i>Discard
      </button>
      <button class="bg-blue-500 hover:bg-blue-600 text-white px-5 py-2 rounded-md" (click)="sendEmail()">
        <i class="fas fa-paper-plane mr-2"></i>Send
      </button>
    </div>
  </div>
</div>
