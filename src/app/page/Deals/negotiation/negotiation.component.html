<app-leadtable-header-features></app-leadtable-header-features>

<!-- Negotiation Table -->
<table class="w-full mt-4 text-sm text-gray-700 border border-gray-200">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-2">Lead Name</th>
      <th class="p-2">Proposed Date</th>
      <th class="p-2">Proposed Value</th>
      <th class="p-2">Actual Value</th>
      <th class="p-2">Status</th>
      <th class="p-2">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let negotiation of negotiations">
      <td class="p-2">{{ negotiation.leadName }}</td>
      <td class="p-2">{{ negotiation.proposedDate }}</td>
      <td class="p-2">{{ negotiation.proposedValue }}</td>
      <td class="p-2">{{ negotiation.actualValue }}</td>
      <td class="p-2">
        <span class="inline-block px-2 py-1 rounded text-xs font-semibold"
              [ngClass]="getBadgeClass(negotiation.status)">
          {{ negotiation.status }}
        </span>
      </td>
      <td class="p-2 text-center space-x-2">
        <button title="Edit" (click)="editNegotiation(negotiation)" class="text-green-600 hover:text-green-800">
          <i class="fas fa-edit"></i>
        </button>
        <button title="Delete" (click)="deleteNegotiation(negotiation)" class="text-red-600 hover:text-red-800">
          <i class="fas fa-trash-alt"></i>
        </button>
        <button title="Negotiate" (click)="openNegotiationModal(negotiation)" class="text-blue-600 hover:text-blue-800">
          <i class="fas fa-handshake"></i>
        </button>
      </td>
    </tr>
  </tbody>
</table>


<!-- Modal Background -->
<div *ngIf="showNegotiationModal" class="fixed inset-0 flex items-center justify-center z-50 backdrop-blur-sm bg-white/40">
    <!-- Modal Card -->
    <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-2xl">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-gray-800">
          <i class="fas fa-handshake mr-2 text-blue-500"></i>Negotiation Details
        </h2>
        <button (click)="closeNegotiationModal()" class="text-gray-500 hover:text-red-600 text-xl">
          <i class="fas fa-times"></i>
        </button>
      </div>
  
      <!-- Form Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Deal Name</label>
          <input [(ngModel)]="negotiationForm.dealName" type="text" class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Proposed Value</label>
          <input [(ngModel)]="negotiationForm.proposedValue" type="number" class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Closed Value</label>
          <input [(ngModel)]="negotiationForm.closedValue" type="number" class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-green-200">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Proposed Date</label>
          <input [(ngModel)]="negotiationForm.proposedDate" type="date" class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-200">
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700">Closed Date</label>
          <input [(ngModel)]="negotiationForm.closedDate" type="date" class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-green-200">
        </div>
      </div>
  
      <!-- Action Buttons -->
      <div class="mt-6 flex justify-end space-x-4">
        <button (click)="markAsWon()" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center">
          <i class="fas fa-thumbs-up mr-2"></i>Won
        </button>
        <button (click)="markAsLost()" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 flex items-center">
          <i class="fas fa-thumbs-down mr-2"></i>Lost
        </button>
      </div>
    </div>
  </div>
  