
<app-pagination></app-pagination> -->


<app-leadtable-header-features (addLeadClicked)="togglePreviewRow()"></app-leadtable-header-features>

<!-- Dropdown view for available lead sources -->
<div *ngIf="showPreviewRow" class="mt-4 mx-4">
  <div class="space-y-2">
    <div *ngFor="let source of leadSources" class="flex flex-wrap justify-between items-center gap-4 bg-blue-50 border border-blue-200 p-4 rounded shadow text-sm text-gray-700">
      <div class="flex flex-wrap gap-3">
        <span><strong>Name:</strong> {{ source.leadName }}</span>
        <span><strong>Email:</strong> {{ source.leadEmail }}</span>
        <span><strong>Contact No:</strong> {{ source.contactNo }}</span>
        <span><strong>Company Name:</strong> {{ source.companyName }}</span>
        <span><strong>Company Add:</strong> {{ source.companyAdd }}</span>
      <span><strong>Source:</strong> {{ source.sourceType }}</span>
        <span><strong>Service:</strong> {{ source.crmService.serviceName }}</span>
        <span><strong>Date:</strong> {{ source.timeStamp | date: 'dd MMM yyyy, hh:mm a' }}</span>

       
      </div>
      <button (click)="addLeadFromSource(source)" class="bg-blue-600 text-white px-4 py-1 rounded hover:bg-blue-700">
        Add
      </button>
    </div>
  </div>
</div>

<!-- Leads Table -->
<table class="w-full mt-4 text-sm text-gray-700 border border-gray-200">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-2">Lead Name</th>
      <th class="p-2">Lead Email</th>
      <th class="p-2">Contact No</th>
      <th class="p-2">Company Name</th>
      <th class="p-2">Company Address</th>
      <th class="p-2">Source Type</th>
      <th class="p-2">Service Name</th>
      <th class="p-2">Date</th>
      <th class="p-2">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let lead of leads">
      <td class="p-2">{{ lead.leadName }}</td>
      <td class="p-2">{{ lead.leadEmail }}</td>
      <td class="p-2">{{ lead.contactNo }}</td>
      <td class="p-2">{{ lead.companyName }}</td>
      <td class="p-2">{{ lead.companyAdd }}</td>
      <td class="p-2">{{ lead.sourceType }}</td>
      <td class="p-2">{{ lead.crmService.serviceName }}</td>
      <td class="p-2">{{ lead.timeDate }}</td>
    

      <td class="p-2">

        <div *ngIf="lead.leadStatus === 'NEW_LEAD'; else staticStatus">
          <select
          [(ngModel)]="lead.leadStatus"
          (change)="onStatusChange(lead)"
          class="border px-2 py-1 rounded text-sm"
          >
          <option value="NEW_LEAD">NEW_LEAD</option>
          <option value="QUALIFIED">QUALIFIED</option>
          </select>
          </div>

          <ng-template #staticStatus>
          <span class="inline-block px-2 py-1 rounded text-xs font-semibold"
                [ngClass]="getBadgeClass(lead.leadStatus)">
            {{ lead.leadStatus }}
          </span>
          </ng-template>
      </td>
    </tr>
  </tbody>
</table>

<app-pagination></app-pagination>
