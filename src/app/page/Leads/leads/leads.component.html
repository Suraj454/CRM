
<app-leadtable-header-features (addLeadClicked)="togglePreviewRow()"></app-leadtable-header-features>

<!-- Dropdown view for available lead sources -->
<div *ngIf="showPreviewRow" class="mt-8 mx-8">
  <div class="space-y-6">
    <div *ngFor="let source of leadSources" class="flex items-center justify-between border border-gray-300 bg-blue-50 px-8 py-6 rounded-2xl shadow-md hover:bg-blue-100 transition duration-300 text-lg text-gray-800 font-[Inter]">

      <!-- Data row -->
      <div class="flex flex-wrap gap-x-10 gap-y-3 items-center w-full">
        <span><span class="text-blue-900 font-semibold text-lg">Name:</span> {{ source.leadName }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Email:</span> {{ source.leadEmail }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Contact:</span> {{ source.contactNo }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Company:</span> {{ source.companyName }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Address:</span> {{ source.companyAdd }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Source:</span> {{ source.sourceType }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Service:</span> {{ source.crmService?.serviceName }}</span>
        <span><span class="text-blue-900 font-semibold text-lg">Date:</span> {{ source.timeStamp | date: 'dd MMM yyyy, hh:mm a' }}</span>
      </div>

      <!-- Action button -->
      <button 
        (click)="addLeadFromSource(source)" 
        class="ml-6 bg-blue-600 text-white px-8 py-2 rounded-lg hover:bg-blue-700 transition duration-200 text-md font-medium shadow-lg"
      >
        Add
      </button>
    </div>
  </div>
</div>





<!-- Leads Table -->
 
<table class="w-full mt-4 text-sm text-gray-700 border border-gray-200">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-2">Lead Name</th>
      <th class="p-2">Lead Email</th>
      <th class="p-2">Contact No</th>
      <th class="p-2">Company Name</th>
      <th class="p-2">Company Address</th>
      <th class="p-2">Source Type</th>
      <th class="p-2">Service Name</th>
      <th class="p-2">Date</th>
      <th class="p-2">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let lead of leads">
      <td class="p-2">{{ lead.leadName }}</td>
      <td class="p-2">{{ lead.leadEmail }}</td>
      <td class="p-2">{{ lead.contactNo }}</td>
      <td class="p-2">{{ lead.companyName }}</td>
      <td class="p-2">{{ lead.companyAdd }}</td>
      <td class="p-2">{{ lead.sourceType }}</td>
      <td class="p-2">{{ lead.crmService.serviceName }}</td>
      <td class="p-2">{{ lead.timeDate }}</td>
    



      <td class="p-2">
        <div *ngIf="lead.leadStatus === 'NEW_LEAD'; else staticStatus">
          <select
            [(ngModel)]="lead.leadStatus"
            (change)="onStatusChange(lead)"
            class="appearance-none bg-blue-100 text-blue-800 border border-blue-300 px-2 py-1 rounded-md text-xs font-semibold shadow-sm focus:outline-none"
          >
            <option value="NEW_LEAD">NEW LEAD</option>
            <option value="QUALIFIED">QUALIFIED</option>
          </select>
        </div>
      
        <ng-template #staticStatus>
          <span
            class="inline-block px-2 py-1 rounded text-xs font-semibold"
            [ngClass]="getBadgeClass(lead.leadStatus)"
          >
            {{ lead.leadStatus }}
          </span>
        </ng-template>
      </td>
      
   

    </tr>
  </tbody>
</table>

<app-pagination></app-pagination>
